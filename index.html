<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acceso Restringido</title>
<style>
body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #f0f0f0;
}
.container {
    background-color: white;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    width: 300px;
    text-align: center;
}
input[type="text"], input[type="password"] {
    width: 100%;
    padding: 8px;
    margin: 10px 0;
    box-sizing: border-box;
}
button {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
button:hover {
    background-color: #0056b3;
}
.error {
    color: red;
    font-size: 0.9em;
    display: none;
}
.hidden {
    display: none;
}
.buttons-container button {
    width: 100%;
    margin: 5px 0;
}
</style>
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
<div class="container">
    <div id="login-form">
        <h2>EToolz</h2>
        <input type="text" id="username" placeholder="Usuario">
        <input type="password" id="password" placeholder="Contrase침a">
        <button onclick="login()">Ingresar</button>
        <p class="error" id="error">Usuario o contrase침a incorrectos</p>
    </div>

    <div id="menu-buttons" class="hidden">
        <h2>Menu</h2>
        <div class="buttons-container" id="user-buttons"></div>
        <button onclick="logout()">Cerrar sesi칩n</button>
    </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyARrsVZ2LboEe5MblE8GKXVnas-zHB4k5I",
  authDomain: "et-accounts.firebaseapp.com",
  databaseURL: "https://et-accounts-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "et-accounts",
  storageBucket: "et-accounts.firebasestorage.app",
  messagingSenderId: "1006439185867",
  appId: "1:1006439185867:web:ee9221150be923340e4a4e"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const usersRef = database.ref('users');

// Mantener sesi칩n iniciada
window.onload = async function() {
    const currentUser = localStorage.getItem("currentUser");
    if(currentUser) {
        const snapshot = await usersRef.child(currentUser).get();
        if(snapshot.exists()) {
            showMenu(currentUser, snapshot.val().pages);
        }
    }
}

async function login() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const error = document.getElementById('error');

    const snapshot = await usersRef.child(username).get();
    if(snapshot.exists()) {
        const userData = snapshot.val();
        if(btoa(password) === userData.password) {
            localStorage.setItem("currentUser", username);
            showMenu(username, userData.pages);
            error.style.display = "none";
            return;
        }
    }
    error.style.display = "block";
}

function showMenu(username, pages) {
    document.getElementById('login-form').classList.add('hidden');
    document.getElementById('menu-buttons').classList.remove('hidden');
    const buttonsDiv = document.getElementById('user-buttons');
    buttonsDiv.innerHTML = "";
    pages.forEach(page => {
        const btn = document.createElement("button");
        btn.textContent = `Ir a ${page}`;
        btn.onclick = () => { window.location.href = page; };
        buttonsDiv.appendChild(btn);
    });
}

function logout() {
    localStorage.removeItem("currentUser");
    document.getElementById('login-form').classList.remove('hidden');
    document.getElementById('menu-buttons').classList.add('hidden');
}
</script>
</body>
</html>



